var PoI18nModule_1;
import { __decorate } from "tslib";
import { HttpClient, HttpClientModule } from '@angular/common/http';
import { APP_INITIALIZER, NgModule } from '@angular/core';
import { PoLanguageService } from './../po-language/po-language.service';
import { I18N_CONFIG } from './po-i18n-config-injection-token';
import { returnPoI18nService, PoI18nService } from './po-i18n.service';
import { PoLanguageModule } from '../po-language/po-language.module';
/**
 * @description
 *
 * Módulo do serviço `PoI18nService` para controle de idiomas com PO.
 *
 * Para utilização do serviço de idiomas `PoI18nService`, deve-se importar este módulo mesmo já havendo importado
 * o módulo `PoModule`. Na importação deve ser invocado o método `config`, informando um objeto que deve implementar
 * a interface [`PoI18nConfig`](documentation/po-i18n#poI18nConfig) para configuração.
 *
 * <a id="i18n-config"></a>
 * **Exemplo de configuração do módulo do i18n:**
 * ```
 * import { PoI18nConfig } from '@po-ui/ng-components';
 *
 * import { generalEn } from './i18n/general-en';
 * import { generalPt } from './i18n/general-pt';
 *
 * const i18nConfig: PoI18nConfig = {
 *   default: {
 *     language: 'pt-BR',
 *     context: 'general',
 *     cache: true
 *   },
 *   contexts: {
 *     general: {
 *       'pt-BR': generalPt,
 *       'en-US': generalEn
 *     },
 *     hcm: {
 *       url: 'http://10.1.1.1/api/translations/hcm/'
 *     }
 *   }
 * };
 *
 * @NgModule({
 *   declarations: [],
 *   imports: [
 *     PoModule,
 *     PoI18nModule.config(i18nConfig)
 *   ],
 *   bootstrap: [AppComponent]
 * })
 * ```
 *
 * Para cada contexto é possível definir a origem das literais, que podem ser de um serviço REST ou
 * de um objeto. Exemplo:
 *
 * Arquivo general-pt.ts
 * ```
 * export const generalPt = {
 *  add: 'Adicionar',
 *  greeting: 'Prazer, {0} {1}',
 *  people: '{0} Pessoas,
 *  remove: 'Remover'
 * }
 * ```
 *
 * Arquivo general-en.ts
 * ```
 * export const generalEn = {
 *  add: 'Add',
 *  greeting: 'Nice to meet you, {0} {1}',
 *  people: '{0} People,
 *  remove: 'Remove'
 * }
 * ```
 *
 * **Exemplo de configuração de contextos usando constantes externas:**
 * ```
 * import { PoI18nConfig } from '@po-ui/ng-components';
 *
 * import { generalEn } from './i18n/general-en';
 * import { generalPt } from './i18n/general-pt';
 *
 * const i18nConfig: PoI18nConfig = {
 *   contexts: {
 *     general: {
 *       'pt-BR': generalPt, // constantes em arquivos separados
 *       'en-US': generalEn // constantes em arquivos separados
 *     },
 *     crm: {
 *       url: 'http://10.0.0.1:3000/api/translations/crm'
 *     }
 *   },
 *   default: {}
 * }
 * ```
 *
 * **Exemplo de configuração de um contexto utilizando serviço:**
 *
 * Ao optar por utilizar um serviço para configuração de contexto, deverá ser definida a URL
 * específica do contexto, como nos exemplos abaixo:
 *
 *  - http://10.0.0.1:3000/api/translations/crm
 *  - http://10.0.0.1:3000/api/translations/general
 *
 * Os idiomas e literais serão automaticamente buscados com parâmetros na própria URL:
 * - **language**: o idioma será sempre passado por parâmetro e é recomendado utilizar uma das linguagens
 * suportadas pelo PO (`pt-br`, `en-us` ou `es-es`).
 * - **literals**: as literais serão separadas por vírgula. Caso esse parâmetro não seja informado, o
 * serviço deve retornar todas as literais do idioma.
 *
 * Exemplos de requisição:
 *
 *  - http://10.0.0.1:3000/api/translations/crm?language=pt-br
 *  - http://10.0.0.1:3000/api/translations/crm?language=pt-br&literals=add,remove,text
 *
 * > Sempre que o idioma solicitado não for encontrado, será buscado por `pt-br`.
 *
 * Além dos contextos, é possível definir as configurações *default* do sistema na configuração do
 * módulo utilizando a interface [`PoI18nConfig`](documentation/po-i18n#poI18nConfig):
 *
 * **Exemplo de padrões definidos:**
 * ```
 * const i18nConfig: PoI18nConfig = {
 *   contexts: {
 *     general: { }
 *   },
 *   default: {
 *    language: 'pt-BR',
 *    context: 'general',
 *    cache: true
 *   }
 * }
 * ```
 *
 * **Importante:**
 *
 * Recomenda-se que as definições *default* sejam realizadas apenas uma vez na aplicação,
 * preferencialmente no módulo `AppModule`.
 *
 * **i18n com *Lazy loading***
 *
 * Para aplicações que utilizem a abordagem de módulos com carregamento *lazy loading*, caso seja
 * definida outra configuração do `PoI18nModule`, deve-se atentar os seguintes detalhes:
 *
 * - Caso existam literais comuns na aplicação, estas devem ser reimportadas;
 * - Não defina outra *default language* para este módulo. Caso for definida, será sobreposta para
 * toda a aplicação;
 * - Caso precise de módulos carregados via *lazy loading* com linguagens diferentes, utilize o
 * método [`setLanguage()`](documentation/po-i18n#setLanguage) disponibilizado pelo `PoI18nService`
 * para definir a linguagem da aplicação e dos módulos com as linguagens diferentes.
 */
let PoI18nModule = PoI18nModule_1 = class PoI18nModule {
    static config(config) {
        return {
            ngModule: PoI18nModule_1,
            providers: [
                {
                    provide: I18N_CONFIG,
                    useValue: config
                },
                {
                    provide: APP_INITIALIZER,
                    useFactory: initializeLanguageDefault,
                    multi: true,
                    deps: [I18N_CONFIG, PoLanguageService]
                },
                {
                    provide: PoI18nService,
                    useFactory: returnPoI18nService,
                    deps: [I18N_CONFIG, HttpClient, PoLanguageService]
                }
            ]
        };
    }
};
PoI18nModule = PoI18nModule_1 = __decorate([
    NgModule({
        imports: [HttpClientModule, PoLanguageModule]
    })
], PoI18nModule);
export { PoI18nModule };
export function initializeLanguageDefault(config, languageService) {
    // tslint:disable-next-line:prefer-immediate-return
    const setDefaultLanguage = () => {
        if (config.default.language) {
            languageService.setLanguageDefault(config.default.language);
        }
    };
    return setDefaultLanguage;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8taTE4bi5tb2R1bGUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AcG8tdWkvbmctY29tcG9uZW50cy8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlcy9wby1pMThuL3BvLWkxOG4ubW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3BFLE9BQU8sRUFBRSxlQUFlLEVBQXVCLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUUvRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUV6RSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDL0QsT0FBTyxFQUFFLG1CQUFtQixFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBRXZFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBRXJFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBOElHO0FBS0gsSUFBYSxZQUFZLG9CQUF6QixNQUFhLFlBQVk7SUFDdkIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFvQjtRQUNoQyxPQUFPO1lBQ0wsUUFBUSxFQUFFLGNBQVk7WUFDdEIsU0FBUyxFQUFFO2dCQUNUO29CQUNFLE9BQU8sRUFBRSxXQUFXO29CQUNwQixRQUFRLEVBQUUsTUFBTTtpQkFDakI7Z0JBQ0Q7b0JBQ0UsT0FBTyxFQUFFLGVBQWU7b0JBQ3hCLFVBQVUsRUFBRSx5QkFBeUI7b0JBQ3JDLEtBQUssRUFBRSxJQUFJO29CQUNYLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxpQkFBaUIsQ0FBQztpQkFDdkM7Z0JBQ0Q7b0JBQ0UsT0FBTyxFQUFFLGFBQWE7b0JBQ3RCLFVBQVUsRUFBRSxtQkFBbUI7b0JBQy9CLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxVQUFVLEVBQUUsaUJBQWlCLENBQUM7aUJBQ25EO2FBQ0Y7U0FDRixDQUFDO0lBQ0osQ0FBQztDQUNGLENBQUE7QUF2QlksWUFBWTtJQUh4QixRQUFRLENBQUM7UUFDUixPQUFPLEVBQUUsQ0FBQyxnQkFBZ0IsRUFBRSxnQkFBZ0IsQ0FBQztLQUM5QyxDQUFDO0dBQ1csWUFBWSxDQXVCeEI7U0F2QlksWUFBWTtBQXlCekIsTUFBTSxVQUFVLHlCQUF5QixDQUFDLE1BQW9CLEVBQUUsZUFBa0M7SUFDaEcsbURBQW1EO0lBQ25ELE1BQU0sa0JBQWtCLEdBQUcsR0FBRyxFQUFFO1FBQzlCLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUU7WUFDM0IsZUFBZSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDN0Q7SUFDSCxDQUFDLENBQUM7SUFDRixPQUFPLGtCQUFrQixDQUFDO0FBQzVCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIdHRwQ2xpZW50LCBIdHRwQ2xpZW50TW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgQVBQX0lOSVRJQUxJWkVSLCBNb2R1bGVXaXRoUHJvdmlkZXJzLCBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBQb0xhbmd1YWdlU2VydmljZSB9IGZyb20gJy4vLi4vcG8tbGFuZ3VhZ2UvcG8tbGFuZ3VhZ2Uuc2VydmljZSc7XG5cbmltcG9ydCB7IEkxOE5fQ09ORklHIH0gZnJvbSAnLi9wby1pMThuLWNvbmZpZy1pbmplY3Rpb24tdG9rZW4nO1xuaW1wb3J0IHsgcmV0dXJuUG9JMThuU2VydmljZSwgUG9JMThuU2VydmljZSB9IGZyb20gJy4vcG8taTE4bi5zZXJ2aWNlJztcbmltcG9ydCB7IFBvSTE4bkNvbmZpZyB9IGZyb20gJy4vaW50ZXJmYWNlcy9wby1pMThuLWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUG9MYW5ndWFnZU1vZHVsZSB9IGZyb20gJy4uL3BvLWxhbmd1YWdlL3BvLWxhbmd1YWdlLm1vZHVsZSc7XG5cbi8qKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogTcOzZHVsbyBkbyBzZXJ2acOnbyBgUG9JMThuU2VydmljZWAgcGFyYSBjb250cm9sZSBkZSBpZGlvbWFzIGNvbSBQTy5cbiAqXG4gKiBQYXJhIHV0aWxpemHDp8OjbyBkbyBzZXJ2acOnbyBkZSBpZGlvbWFzIGBQb0kxOG5TZXJ2aWNlYCwgZGV2ZS1zZSBpbXBvcnRhciBlc3RlIG3Ds2R1bG8gbWVzbW8gasOhIGhhdmVuZG8gaW1wb3J0YWRvXG4gKiBvIG3Ds2R1bG8gYFBvTW9kdWxlYC4gTmEgaW1wb3J0YcOnw6NvIGRldmUgc2VyIGludm9jYWRvIG8gbcOpdG9kbyBgY29uZmlnYCwgaW5mb3JtYW5kbyB1bSBvYmpldG8gcXVlIGRldmUgaW1wbGVtZW50YXJcbiAqIGEgaW50ZXJmYWNlIFtgUG9JMThuQ29uZmlnYF0oZG9jdW1lbnRhdGlvbi9wby1pMThuI3BvSTE4bkNvbmZpZykgcGFyYSBjb25maWd1cmHDp8Ojby5cbiAqXG4gKiA8YSBpZD1cImkxOG4tY29uZmlnXCI+PC9hPlxuICogKipFeGVtcGxvIGRlIGNvbmZpZ3VyYcOnw6NvIGRvIG3Ds2R1bG8gZG8gaTE4bjoqKlxuICogYGBgXG4gKiBpbXBvcnQgeyBQb0kxOG5Db25maWcgfSBmcm9tICdAcG8tdWkvbmctY29tcG9uZW50cyc7XG4gKlxuICogaW1wb3J0IHsgZ2VuZXJhbEVuIH0gZnJvbSAnLi9pMThuL2dlbmVyYWwtZW4nO1xuICogaW1wb3J0IHsgZ2VuZXJhbFB0IH0gZnJvbSAnLi9pMThuL2dlbmVyYWwtcHQnO1xuICpcbiAqIGNvbnN0IGkxOG5Db25maWc6IFBvSTE4bkNvbmZpZyA9IHtcbiAqICAgZGVmYXVsdDoge1xuICogICAgIGxhbmd1YWdlOiAncHQtQlInLFxuICogICAgIGNvbnRleHQ6ICdnZW5lcmFsJyxcbiAqICAgICBjYWNoZTogdHJ1ZVxuICogICB9LFxuICogICBjb250ZXh0czoge1xuICogICAgIGdlbmVyYWw6IHtcbiAqICAgICAgICdwdC1CUic6IGdlbmVyYWxQdCxcbiAqICAgICAgICdlbi1VUyc6IGdlbmVyYWxFblxuICogICAgIH0sXG4gKiAgICAgaGNtOiB7XG4gKiAgICAgICB1cmw6ICdodHRwOi8vMTAuMS4xLjEvYXBpL3RyYW5zbGF0aW9ucy9oY20vJ1xuICogICAgIH1cbiAqICAgfVxuICogfTtcbiAqXG4gKiBATmdNb2R1bGUoe1xuICogICBkZWNsYXJhdGlvbnM6IFtdLFxuICogICBpbXBvcnRzOiBbXG4gKiAgICAgUG9Nb2R1bGUsXG4gKiAgICAgUG9JMThuTW9kdWxlLmNvbmZpZyhpMThuQ29uZmlnKVxuICogICBdLFxuICogICBib290c3RyYXA6IFtBcHBDb21wb25lbnRdXG4gKiB9KVxuICogYGBgXG4gKlxuICogUGFyYSBjYWRhIGNvbnRleHRvIMOpIHBvc3PDrXZlbCBkZWZpbmlyIGEgb3JpZ2VtIGRhcyBsaXRlcmFpcywgcXVlIHBvZGVtIHNlciBkZSB1bSBzZXJ2acOnbyBSRVNUIG91XG4gKiBkZSB1bSBvYmpldG8uIEV4ZW1wbG86XG4gKlxuICogQXJxdWl2byBnZW5lcmFsLXB0LnRzXG4gKiBgYGBcbiAqIGV4cG9ydCBjb25zdCBnZW5lcmFsUHQgPSB7XG4gKiAgYWRkOiAnQWRpY2lvbmFyJyxcbiAqICBncmVldGluZzogJ1ByYXplciwgezB9IHsxfScsXG4gKiAgcGVvcGxlOiAnezB9IFBlc3NvYXMsXG4gKiAgcmVtb3ZlOiAnUmVtb3ZlcidcbiAqIH1cbiAqIGBgYFxuICpcbiAqIEFycXVpdm8gZ2VuZXJhbC1lbi50c1xuICogYGBgXG4gKiBleHBvcnQgY29uc3QgZ2VuZXJhbEVuID0ge1xuICogIGFkZDogJ0FkZCcsXG4gKiAgZ3JlZXRpbmc6ICdOaWNlIHRvIG1lZXQgeW91LCB7MH0gezF9JyxcbiAqICBwZW9wbGU6ICd7MH0gUGVvcGxlLFxuICogIHJlbW92ZTogJ1JlbW92ZSdcbiAqIH1cbiAqIGBgYFxuICpcbiAqICoqRXhlbXBsbyBkZSBjb25maWd1cmHDp8OjbyBkZSBjb250ZXh0b3MgdXNhbmRvIGNvbnN0YW50ZXMgZXh0ZXJuYXM6KipcbiAqIGBgYFxuICogaW1wb3J0IHsgUG9JMThuQ29uZmlnIH0gZnJvbSAnQHBvLXVpL25nLWNvbXBvbmVudHMnO1xuICpcbiAqIGltcG9ydCB7IGdlbmVyYWxFbiB9IGZyb20gJy4vaTE4bi9nZW5lcmFsLWVuJztcbiAqIGltcG9ydCB7IGdlbmVyYWxQdCB9IGZyb20gJy4vaTE4bi9nZW5lcmFsLXB0JztcbiAqXG4gKiBjb25zdCBpMThuQ29uZmlnOiBQb0kxOG5Db25maWcgPSB7XG4gKiAgIGNvbnRleHRzOiB7XG4gKiAgICAgZ2VuZXJhbDoge1xuICogICAgICAgJ3B0LUJSJzogZ2VuZXJhbFB0LCAvLyBjb25zdGFudGVzIGVtIGFycXVpdm9zIHNlcGFyYWRvc1xuICogICAgICAgJ2VuLVVTJzogZ2VuZXJhbEVuIC8vIGNvbnN0YW50ZXMgZW0gYXJxdWl2b3Mgc2VwYXJhZG9zXG4gKiAgICAgfSxcbiAqICAgICBjcm06IHtcbiAqICAgICAgIHVybDogJ2h0dHA6Ly8xMC4wLjAuMTozMDAwL2FwaS90cmFuc2xhdGlvbnMvY3JtJ1xuICogICAgIH1cbiAqICAgfSxcbiAqICAgZGVmYXVsdDoge31cbiAqIH1cbiAqIGBgYFxuICpcbiAqICoqRXhlbXBsbyBkZSBjb25maWd1cmHDp8OjbyBkZSB1bSBjb250ZXh0byB1dGlsaXphbmRvIHNlcnZpw6dvOioqXG4gKlxuICogQW8gb3B0YXIgcG9yIHV0aWxpemFyIHVtIHNlcnZpw6dvIHBhcmEgY29uZmlndXJhw6fDo28gZGUgY29udGV4dG8sIGRldmVyw6Egc2VyIGRlZmluaWRhIGEgVVJMXG4gKiBlc3BlY8OtZmljYSBkbyBjb250ZXh0bywgY29tbyBub3MgZXhlbXBsb3MgYWJhaXhvOlxuICpcbiAqICAtIGh0dHA6Ly8xMC4wLjAuMTozMDAwL2FwaS90cmFuc2xhdGlvbnMvY3JtXG4gKiAgLSBodHRwOi8vMTAuMC4wLjE6MzAwMC9hcGkvdHJhbnNsYXRpb25zL2dlbmVyYWxcbiAqXG4gKiBPcyBpZGlvbWFzIGUgbGl0ZXJhaXMgc2Vyw6NvIGF1dG9tYXRpY2FtZW50ZSBidXNjYWRvcyBjb20gcGFyw6JtZXRyb3MgbmEgcHLDs3ByaWEgVVJMOlxuICogLSAqKmxhbmd1YWdlKio6IG8gaWRpb21hIHNlcsOhIHNlbXByZSBwYXNzYWRvIHBvciBwYXLDom1ldHJvIGUgw6kgcmVjb21lbmRhZG8gdXRpbGl6YXIgdW1hIGRhcyBsaW5ndWFnZW5zXG4gKiBzdXBvcnRhZGFzIHBlbG8gUE8gKGBwdC1icmAsIGBlbi11c2Agb3UgYGVzLWVzYCkuXG4gKiAtICoqbGl0ZXJhbHMqKjogYXMgbGl0ZXJhaXMgc2Vyw6NvIHNlcGFyYWRhcyBwb3IgdsOtcmd1bGEuIENhc28gZXNzZSBwYXLDom1ldHJvIG7Do28gc2VqYSBpbmZvcm1hZG8sIG9cbiAqIHNlcnZpw6dvIGRldmUgcmV0b3JuYXIgdG9kYXMgYXMgbGl0ZXJhaXMgZG8gaWRpb21hLlxuICpcbiAqIEV4ZW1wbG9zIGRlIHJlcXVpc2nDp8OjbzpcbiAqXG4gKiAgLSBodHRwOi8vMTAuMC4wLjE6MzAwMC9hcGkvdHJhbnNsYXRpb25zL2NybT9sYW5ndWFnZT1wdC1iclxuICogIC0gaHR0cDovLzEwLjAuMC4xOjMwMDAvYXBpL3RyYW5zbGF0aW9ucy9jcm0/bGFuZ3VhZ2U9cHQtYnImbGl0ZXJhbHM9YWRkLHJlbW92ZSx0ZXh0XG4gKlxuICogPiBTZW1wcmUgcXVlIG8gaWRpb21hIHNvbGljaXRhZG8gbsOjbyBmb3IgZW5jb250cmFkbywgc2Vyw6EgYnVzY2FkbyBwb3IgYHB0LWJyYC5cbiAqXG4gKiBBbMOpbSBkb3MgY29udGV4dG9zLCDDqSBwb3Nzw612ZWwgZGVmaW5pciBhcyBjb25maWd1cmHDp8O1ZXMgKmRlZmF1bHQqIGRvIHNpc3RlbWEgbmEgY29uZmlndXJhw6fDo28gZG9cbiAqIG3Ds2R1bG8gdXRpbGl6YW5kbyBhIGludGVyZmFjZSBbYFBvSTE4bkNvbmZpZ2BdKGRvY3VtZW50YXRpb24vcG8taTE4biNwb0kxOG5Db25maWcpOlxuICpcbiAqICoqRXhlbXBsbyBkZSBwYWRyw7VlcyBkZWZpbmlkb3M6KipcbiAqIGBgYFxuICogY29uc3QgaTE4bkNvbmZpZzogUG9JMThuQ29uZmlnID0ge1xuICogICBjb250ZXh0czoge1xuICogICAgIGdlbmVyYWw6IHsgfVxuICogICB9LFxuICogICBkZWZhdWx0OiB7XG4gKiAgICBsYW5ndWFnZTogJ3B0LUJSJyxcbiAqICAgIGNvbnRleHQ6ICdnZW5lcmFsJyxcbiAqICAgIGNhY2hlOiB0cnVlXG4gKiAgIH1cbiAqIH1cbiAqIGBgYFxuICpcbiAqICoqSW1wb3J0YW50ZToqKlxuICpcbiAqIFJlY29tZW5kYS1zZSBxdWUgYXMgZGVmaW5pw6fDtWVzICpkZWZhdWx0KiBzZWphbSByZWFsaXphZGFzIGFwZW5hcyB1bWEgdmV6IG5hIGFwbGljYcOnw6NvLFxuICogcHJlZmVyZW5jaWFsbWVudGUgbm8gbcOzZHVsbyBgQXBwTW9kdWxlYC5cbiAqXG4gKiAqKmkxOG4gY29tICpMYXp5IGxvYWRpbmcqKipcbiAqXG4gKiBQYXJhIGFwbGljYcOnw7VlcyBxdWUgdXRpbGl6ZW0gYSBhYm9yZGFnZW0gZGUgbcOzZHVsb3MgY29tIGNhcnJlZ2FtZW50byAqbGF6eSBsb2FkaW5nKiwgY2FzbyBzZWphXG4gKiBkZWZpbmlkYSBvdXRyYSBjb25maWd1cmHDp8OjbyBkbyBgUG9JMThuTW9kdWxlYCwgZGV2ZS1zZSBhdGVudGFyIG9zIHNlZ3VpbnRlcyBkZXRhbGhlczpcbiAqXG4gKiAtIENhc28gZXhpc3RhbSBsaXRlcmFpcyBjb211bnMgbmEgYXBsaWNhw6fDo28sIGVzdGFzIGRldmVtIHNlciByZWltcG9ydGFkYXM7XG4gKiAtIE7Do28gZGVmaW5hIG91dHJhICpkZWZhdWx0IGxhbmd1YWdlKiBwYXJhIGVzdGUgbcOzZHVsby4gQ2FzbyBmb3IgZGVmaW5pZGEsIHNlcsOhIHNvYnJlcG9zdGEgcGFyYVxuICogdG9kYSBhIGFwbGljYcOnw6NvO1xuICogLSBDYXNvIHByZWNpc2UgZGUgbcOzZHVsb3MgY2FycmVnYWRvcyB2aWEgKmxhenkgbG9hZGluZyogY29tIGxpbmd1YWdlbnMgZGlmZXJlbnRlcywgdXRpbGl6ZSBvXG4gKiBtw6l0b2RvIFtgc2V0TGFuZ3VhZ2UoKWBdKGRvY3VtZW50YXRpb24vcG8taTE4biNzZXRMYW5ndWFnZSkgZGlzcG9uaWJpbGl6YWRvIHBlbG8gYFBvSTE4blNlcnZpY2VgXG4gKiBwYXJhIGRlZmluaXIgYSBsaW5ndWFnZW0gZGEgYXBsaWNhw6fDo28gZSBkb3MgbcOzZHVsb3MgY29tIGFzIGxpbmd1YWdlbnMgZGlmZXJlbnRlcy5cbiAqL1xuXG5ATmdNb2R1bGUoe1xuICBpbXBvcnRzOiBbSHR0cENsaWVudE1vZHVsZSwgUG9MYW5ndWFnZU1vZHVsZV1cbn0pXG5leHBvcnQgY2xhc3MgUG9JMThuTW9kdWxlIHtcbiAgc3RhdGljIGNvbmZpZyhjb25maWc6IFBvSTE4bkNvbmZpZyk6IE1vZHVsZVdpdGhQcm92aWRlcnM8UG9JMThuTW9kdWxlPiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5nTW9kdWxlOiBQb0kxOG5Nb2R1bGUsXG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IEkxOE5fQ09ORklHLFxuICAgICAgICAgIHVzZVZhbHVlOiBjb25maWdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IEFQUF9JTklUSUFMSVpFUixcbiAgICAgICAgICB1c2VGYWN0b3J5OiBpbml0aWFsaXplTGFuZ3VhZ2VEZWZhdWx0LFxuICAgICAgICAgIG11bHRpOiB0cnVlLFxuICAgICAgICAgIGRlcHM6IFtJMThOX0NPTkZJRywgUG9MYW5ndWFnZVNlcnZpY2VdXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBQb0kxOG5TZXJ2aWNlLFxuICAgICAgICAgIHVzZUZhY3Rvcnk6IHJldHVyblBvSTE4blNlcnZpY2UsXG4gICAgICAgICAgZGVwczogW0kxOE5fQ09ORklHLCBIdHRwQ2xpZW50LCBQb0xhbmd1YWdlU2VydmljZV1cbiAgICAgICAgfVxuICAgICAgXVxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVMYW5ndWFnZURlZmF1bHQoY29uZmlnOiBQb0kxOG5Db25maWcsIGxhbmd1YWdlU2VydmljZTogUG9MYW5ndWFnZVNlcnZpY2UpIHtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1pbW1lZGlhdGUtcmV0dXJuXG4gIGNvbnN0IHNldERlZmF1bHRMYW5ndWFnZSA9ICgpID0+IHtcbiAgICBpZiAoY29uZmlnLmRlZmF1bHQubGFuZ3VhZ2UpIHtcbiAgICAgIGxhbmd1YWdlU2VydmljZS5zZXRMYW5ndWFnZURlZmF1bHQoY29uZmlnLmRlZmF1bHQubGFuZ3VhZ2UpO1xuICAgIH1cbiAgfTtcbiAgcmV0dXJuIHNldERlZmF1bHRMYW5ndWFnZTtcbn1cbiJdfQ==