import { __decorate, __metadata } from "tslib";
import { Component, ViewChild } from '@angular/core';
import { browserLanguage, poLocaleDefault } from '../../utils/util';
import { PoDialogType } from './po-dialog.enum';
import { PoModalComponent } from '../../components/po-modal/po-modal.component';
export const poDialogAlertLiteralsDefault = {
    en: { ok: 'Ok' },
    es: { ok: 'Ok' },
    pt: { ok: 'Ok' },
    ru: { ok: 'Ок' }
};
export const poDialogConfirmLiteralsDefault = {
    en: { cancel: 'Cancel', confirm: 'Confirm' },
    es: { cancel: 'Cancelar', confirm: 'Confirmar' },
    pt: { cancel: 'Cancelar', confirm: 'Confirmar' },
    ru: { cancel: 'отменить', confirm: 'подтвердить' }
};
/**
 * @docsPrivate
 *
 * @description
 *
 * Componente que serve como container do po-dialog.service
 */
let PoDialogComponent = class PoDialogComponent {
    constructor() {
        // Objeto primary do poModal
        this.primaryAction = { label: 'ok', action: () => { } };
    }
    ngOnDestroy() {
        this.closeSubscription.unsubscribe();
    }
    ngOnInit() {
        this.closeSubscription = this.poModal.onXClosed.subscribe(close => this.destroy());
    }
    // Fecha o poModal
    close() {
        this.poModal.close();
        this.destroy();
    }
    destroy() {
        if (this.componentRef) {
            this.componentRef.destroy();
        }
    }
    // Insere os valores recebidos de this.open para o poModal
    configDialog(primaryLabel, primaryAction, secondaryLabel, secondaryAction) {
        this.primaryAction = {
            label: primaryLabel,
            action: () => {
                if (primaryAction) {
                    primaryAction();
                }
                this.close();
            }
        };
        if (secondaryLabel) {
            this.secondaryAction = {
                label: secondaryLabel,
                action: () => {
                    if (secondaryAction) {
                        secondaryAction();
                    }
                    this.close();
                }
            };
        }
    }
    // Insere os valores recebidos de po-dialog.service de acordo com o tipo de diálago solicitado
    open(dialogOptions, dialogType, componentRef) {
        this.title = dialogOptions.title;
        this.message = dialogOptions.message;
        this.componentRef = componentRef;
        this.setDialogLiterals(dialogOptions, dialogType);
        switch (dialogType) {
            case PoDialogType.Confirm: {
                this.configDialog(this.literalsConfirm.confirm, dialogOptions.confirm, this.literalsConfirm.cancel, dialogOptions.cancel);
                break;
            }
            case PoDialogType.Alert: {
                this.configDialog(this.literalsAlert.ok, dialogOptions.ok);
                break;
            }
        }
        this.poModal.open();
    }
    setDialogLiterals(dialogOptions, dialogType) {
        const alertLiterals = poDialogAlertLiteralsDefault;
        const confirmLiterals = poDialogConfirmLiteralsDefault;
        const literals = dialogOptions.literals;
        if (dialogType === PoDialogType.Alert) {
            this.literalsAlert = Object.assign(Object.assign(Object.assign({}, alertLiterals[poLocaleDefault]), alertLiterals[browserLanguage()]), literals);
        }
        else {
            this.literalsConfirm = Object.assign(Object.assign(Object.assign({}, confirmLiterals[poLocaleDefault]), confirmLiterals[browserLanguage()]), literals);
        }
    }
};
__decorate([
    ViewChild(PoModalComponent, { static: true }),
    __metadata("design:type", PoModalComponent)
], PoDialogComponent.prototype, "poModal", void 0);
PoDialogComponent = __decorate([
    Component({
        template: "<po-modal [p-title]=\"title\" [p-primary-action]=\"primaryAction\" [p-secondary-action]=\"secondaryAction\">\n  {{ message }}\n</po-modal>\n"
    })
], PoDialogComponent);
export { PoDialogComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tZGlhbG9nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bwby11aS9uZy1jb21wb25lbnRzLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL3BvLWRpYWxvZy9wby1kaWFsb2cuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFtQyxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFJdEYsT0FBTyxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUtwRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFaEQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sOENBQThDLENBQUM7QUFFaEYsTUFBTSxDQUFDLE1BQU0sNEJBQTRCLEdBQUc7SUFDMUMsRUFBRSxFQUF5QixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7SUFDdkMsRUFBRSxFQUF5QixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7SUFDdkMsRUFBRSxFQUF5QixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7SUFDdkMsRUFBRSxFQUF5QixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7Q0FDeEMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxNQUFNLDhCQUE4QixHQUFHO0lBQzVDLEVBQUUsRUFBMkIsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUU7SUFDckUsRUFBRSxFQUEyQixFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRTtJQUN6RSxFQUFFLEVBQTJCLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFO0lBQ3pFLEVBQUUsRUFBMkIsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxhQUFhLEVBQUU7Q0FDNUUsQ0FBQztBQUVGOzs7Ozs7R0FNRztBQUtILElBQWEsaUJBQWlCLEdB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RTtZQUNyQyxJQUFJLENBQUMsYUFBYSxpREFBUSxhQUFhLENBQUMsZUFBZSxDQUFDLEdBQUssYUFBYSxDQUFDLGVBQWUsRUFBRSxDQUFDLEdBQUssUUFBUSxDQUFFLENBQUM7U0FDOUc7YUFBTTtZQUNMLElBQUksQ0FBQyxlQUFlLGlEQUNmLGVBQWUsQ0FBQyxlQUFlLENBQUMsR0FDaEMsZUFBZSxDQUFDLGVBQWUsRUFBRSxDQUFDLEdBQ2xDLFFBQVEsQ0FDWixDQUFDO1NBQ0g7SUFDSCxDQUFDO0NBQ0YsQ0FBQTtBQXBIZ0Q7SUFBOUMsU0FBUyxDQUFDLGdCQUFnQixFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxDQUFDOzhCQUFVLGdCQUFnQjtrREFBQztBQUY5RCxpQkFBaUI7SUFIN0IsU0FBUyxDQUFDO1FBQ1Qsd0pBQXlDO0tBQzFDLENBQUM7R0FDVyxpQkFBaUIsQ0FzSDdCO1NBdEhZLGlCQUFpQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgQ29tcG9uZW50UmVmLCBPbkRlc3Ryb3ksIE9uSW5pdCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQgeyBicm93c2VyTGFuZ3VhZ2UsIHBvTG9jYWxlRGVmYXVsdCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWwnO1xuXG5pbXBvcnQgeyBQb0RpYWxvZ0FsZXJ0TGl0ZXJhbHMgfSBmcm9tICcuL2ludGVyZmFjZXMvcG8tZGlhbG9nLWFsZXJ0LWxpdGVyYWxzLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQb0RpYWxvZ0FsZXJ0T3B0aW9ucywgUG9EaWFsb2dDb25maXJtT3B0aW9ucyB9IGZyb20gJy4vaW50ZXJmYWNlcy9wby1kaWFsb2cuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBvRGlhbG9nQ29uZmlybUxpdGVyYWxzIH0gZnJvbSAnLi9pbnRlcmZhY2VzL3BvLWRpYWxvZy1jb25maXJtLWxpdGVyYWxzLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQb0RpYWxvZ1R5cGUgfSBmcm9tICcuL3BvLWRpYWxvZy5lbnVtJztcbmltcG9ydCB7IFBvTW9kYWxBY3Rpb24gfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL3BvLW1vZGFsL3BvLW1vZGFsLWFjdGlvbi5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUG9Nb2RhbENvbXBvbmVudCB9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvcG8tbW9kYWwvcG8tbW9kYWwuY29tcG9uZW50JztcblxuZXhwb3J0IGNvbnN0IHBvRGlhbG9nQWxlcnRMaXRlcmFsc0RlZmF1bHQgPSB7XG4gIGVuOiA8UG9EaWFsb2dBbGVydExpdGVyYWxzPnsgb2s6ICdPaycgfSxcbiAgZXM6IDxQb0RpYWxvZ0FsZXJ0TGl0ZXJhbHM+eyBvazogJ09rJyB9LFxuICBwdDogPFBvRGlhbG9nQWxlcnRMaXRlcmFscz57IG9rOiAnT2snIH0sXG4gIHJ1OiA8UG9EaWFsb2dBbGVydExpdGVyYWxzPnsgb2s6ICfQntC6JyB9XG59O1xuXG5leHBvcnQgY29uc3QgcG9EaWFsb2dDb25maXJtTGl0ZXJhbHNEZWZhdWx0ID0ge1xuICBlbjogPFBvRGlhbG9nQ29uZmlybUxpdGVyYWxzPnsgY2FuY2VsOiAnQ2FuY2VsJywgY29uZmlybTogJ0NvbmZpcm0nIH0sXG4gIGVzOiA8UG9EaWFsb2dDb25maXJtTGl0ZXJhbHM+eyBjYW5jZWw6ICdDYW5jZWxhcicsIGNvbmZpcm06ICdDb25maXJtYXInIH0sXG4gIHB0OiA8UG9EaWFsb2dDb25maXJtTGl0ZXJhbHM+eyBjYW5jZWw6ICdDYW5jZWxhcicsIGNvbmZpcm06ICdDb25maXJtYXInIH0sXG4gIHJ1OiA8UG9EaWFsb2dDb25maXJtTGl0ZXJhbHM+eyBjYW5jZWw6ICfQvtGC0LzQtdC90LjRgtGMJywgY29uZmlybTogJ9C/0L7QtNGC0LLQtdGA0LTQuNGC0YwnIH1cbn07XG5cbi8qKlxuICogQGRvY3NQcml2YXRlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogQ29tcG9uZW50ZSBxdWUgc2VydmUgY29tbyBjb250YWluZXIgZG8gcG8tZGlhbG9nLnNlcnZpY2VcbiAqL1xuXG5AQ29tcG9uZW50KHtcbiAgdGVtcGxhdGVVcmw6ICcuL3BvLWRpYWxvZy5jb21wb25lbnQuaHRtbCdcbn0pXG5leHBvcnQgY2xhc3MgUG9EaWFsb2dDb21wb25lbnQgaW1wbGVtZW50cyBPbkRlc3Ryb3ksIE9uSW5pdCB7XG4gIC8vIFZpZXdDaGlsZCBwYXJhIG8gdXNvIGRvIHBvLW1vZGFsLmNvbXBvbmVudFxuICBAVmlld0NoaWxkKFBvTW9kYWxDb21wb25lbnQsIHsgc3RhdGljOiB0cnVlIH0pIHBvTW9kYWw6IFBvTW9kYWxDb21wb25lbnQ7XG5cbiAgLy8gVGl0bGUgZG8gcG9Nb2RhbFxuICB0aXRsZTogc3RyaW5nO1xuXG4gIC8vIE1lc3NhZ2UgZG8gcG9Nb2RhbFxuICBtZXNzYWdlOiBzdHJpbmc7XG5cbiAgLy8gT2JqZXRvIHByaW1hcnkgZG8gcG9Nb2RhbFxuICBwcmltYXJ5QWN0aW9uOiBQb01vZGFsQWN0aW9uID0geyBsYWJlbDogJ29rJywgYWN0aW9uOiAoKSA9PiB7fSB9O1xuXG4gIC8vIE9iamV0byBzZWNvbmRhcnkgZG8gcG9Nb2RhbFxuICBzZWNvbmRhcnlBY3Rpb246IFBvTW9kYWxBY3Rpb247XG5cbiAgLy8gTGl0ZXJhaXMgdXNhZGFzIG5vcyBib3TDo28gZGUgYWxlcnRhIGRvIHBvTW9kYWxcbiAgbGl0ZXJhbHNBbGVydDogUG9EaWFsb2dBbGVydExpdGVyYWxzO1xuXG4gIC8vIExpdGVyYWlzIHVzYWRhcyBub3MgYm90w7VlcyBkZSBjb25maXJtYcOnw6NvIGRvIHBvTW9kYWxcbiAgbGl0ZXJhbHNDb25maXJtOiBQb0RpYWxvZ0NvbmZpcm1MaXRlcmFscztcblxuICAvLyBBdHJpYnV0byBwYXJhIGFybWF6ZW5hciBhIHJlZmVyZW5jaWEgZG8gY29tcG9uZW50ZSBjcmlhZG8gdmlhIHNlcnZpw6dvLlxuICBwcml2YXRlIGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPFBvRGlhbG9nQ29tcG9uZW50PjtcbiAgcHJpdmF0ZSBjbG9zZVN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMuY2xvc2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMuY2xvc2VTdWJzY3JpcHRpb24gPSB0aGlzLnBvTW9kYWwub25YQ2xvc2VkLnN1YnNjcmliZShjbG9zZSA9PiB0aGlzLmRlc3Ryb3koKSk7XG4gIH1cblxuICAvLyBGZWNoYSBvIHBvTW9kYWxcbiAgY2xvc2UoKTogdm9pZCB7XG4gICAgdGhpcy5wb01vZGFsLmNsb3NlKCk7XG4gICAgdGhpcy5kZXN0cm95KCk7XG4gIH1cblxuICBkZXN0cm95KCkge1xuICAgIGlmICh0aGlzLmNvbXBvbmVudFJlZikge1xuICAgICAgdGhpcy5jb21wb25lbnRSZWYuZGVzdHJveSgpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEluc2VyZSBvcyB2YWxvcmVzIHJlY2ViaWRvcyBkZSB0aGlzLm9wZW4gcGFyYSBvIHBvTW9kYWxcbiAgY29uZmlnRGlhbG9nKHByaW1hcnlMYWJlbD8sIHByaW1hcnlBY3Rpb24/LCBzZWNvbmRhcnlMYWJlbD8sIHNlY29uZGFyeUFjdGlvbj8pIHtcbiAgICB0aGlzLnByaW1hcnlBY3Rpb24gPSB7XG4gICAgICBsYWJlbDogcHJpbWFyeUxhYmVsLFxuICAgICAgYWN0aW9uOiAoKSA9PiB7XG4gICAgICAgIGlmIChwcmltYXJ5QWN0aW9uKSB7XG4gICAgICAgICAgcHJpbWFyeUFjdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKHNlY29uZGFyeUxhYmVsKSB7XG4gICAgICB0aGlzLnNlY29uZGFyeUFjdGlvbiA9IHtcbiAgICAgICAgbGFiZWw6IHNlY29uZGFyeUxhYmVsLFxuICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICBpZiAoc2Vjb25kYXJ5QWN0aW9uKSB7XG4gICAgICAgICAgICBzZWNvbmRhcnlBY3Rpb24oKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8vIEluc2VyZSBvcyB2YWxvcmVzIHJlY2ViaWRvcyBkZSBwby1kaWFsb2cuc2VydmljZSBkZSBhY29yZG8gY29tIG8gdGlwbyBkZSBkacOhbGFnbyBzb2xpY2l0YWRvXG4gIG9wZW4oXG4gICAgZGlhbG9nT3B0aW9uczogUG9EaWFsb2dDb25maXJtT3B0aW9ucyB8IFBvRGlhbG9nQWxlcnRPcHRpb25zLFxuICAgIGRpYWxvZ1R5cGU6IFBvRGlhbG9nVHlwZSxcbiAgICBjb21wb25lbnRSZWY/OiBDb21wb25lbnRSZWY8UG9EaWFsb2dDb21wb25lbnQ+XG4gICk6IHZvaWQge1xuICAgIHRoaXMudGl0bGUgPSBkaWFsb2dPcHRpb25zLnRpdGxlO1xuICAgIHRoaXMubWVzc2FnZSA9IGRpYWxvZ09wdGlvbnMubWVzc2FnZTtcblxuICAgIHRoaXMuY29tcG9uZW50UmVmID0gY29tcG9uZW50UmVmO1xuXG4gICAgdGhpcy5zZXREaWFsb2dMaXRlcmFscyhkaWFsb2dPcHRpb25zLCBkaWFsb2dUeXBlKTtcblxuICAgIHN3aXRjaCAoZGlhbG9nVHlwZSkge1xuICAgICAgY2FzZSBQb0RpYWxvZ1R5cGUuQ29uZmlybToge1xuICAgICAgICB0aGlzLmNvbmZpZ0RpYWxvZyhcbiAgICAgICAgICB0aGlzLmxpdGVyYWxzQ29uZmlybS5jb25maXJtLFxuICAgICAgICAgICg8UG9EaWFsb2dDb25maXJtT3B0aW9ucz5kaWFsb2dPcHRpb25zKS5jb25maXJtLFxuICAgICAgICAgIHRoaXMubGl0ZXJhbHNDb25maXJtLmNhbmNlbCxcbiAgICAgICAgICAoPFBvRGlhbG9nQ29uZmlybU9wdGlvbnM+ZGlhbG9nT3B0aW9ucykuY2FuY2VsXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSBQb0RpYWxvZ1R5cGUuQWxlcnQ6IHtcbiAgICAgICAgdGhpcy5jb25maWdEaWFsb2codGhpcy5saXRlcmFsc0FsZXJ0Lm9rLCAoPFBvRGlhbG9nQWxlcnRPcHRpb25zPmRpYWxvZ09wdGlvbnMpLm9rKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5wb01vZGFsLm9wZW4oKTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0RGlhbG9nTGl0ZXJhbHMoZGlhbG9nT3B0aW9uczogUG9EaWFsb2dDb25maXJtT3B0aW9ucyB8IFBvRGlhbG9nQWxlcnRPcHRpb25zLCBkaWFsb2dUeXBlOiBQb0RpYWxvZ1R5cGUpIHtcbiAgICBjb25zdCBhbGVydExpdGVyYWxzID0gcG9EaWFsb2dBbGVydExpdGVyYWxzRGVmYXVsdDtcbiAgICBjb25zdCBjb25maXJtTGl0ZXJhbHMgPSBwb0RpYWxvZ0NvbmZpcm1MaXRlcmFsc0RlZmF1bHQ7XG4gICAgY29uc3QgbGl0ZXJhbHMgPSBkaWFsb2dPcHRpb25zLmxpdGVyYWxzO1xuXG4gICAgaWYgKGRpYWxvZ1R5cGUgPT09IFBvRGlhbG9nVHlwZS5BbGVydCkge1xuICAgICAgdGhpcy5saXRlcmFsc0FsZXJ0ID0geyAuLi5hbGVydExpdGVyYWxzW3BvTG9jYWxlRGVmYXVsdF0sIC4uLmFsZXJ0TGl0ZXJhbHNbYnJvd3Nlckxhbmd1YWdlKCldLCAuLi5saXRlcmFscyB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxpdGVyYWxzQ29uZmlybSA9IHtcbiAgICAgICAgLi4uY29uZmlybUxpdGVyYWxzW3BvTG9jYWxlRGVmYXVsdF0sXG4gICAgICAgIC4uLmNvbmZpcm1MaXRlcmFsc1ticm93c2VyTGFuZ3VhZ2UoKV0sXG4gICAgICAgIC4uLmxpdGVyYWxzXG4gICAgICB9O1xuICAgIH1cbiAgfVxufVxuIl19