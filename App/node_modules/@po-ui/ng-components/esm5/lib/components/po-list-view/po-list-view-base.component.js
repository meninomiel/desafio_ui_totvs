import { __assign, __decorate, __metadata } from "tslib";
import { EventEmitter, Input, Output, Directive } from '@angular/core';
import { browserLanguage, poLocaleDefault, convertToBoolean } from '../../utils/util';
export var poListViewLiteralsDefault = {
    en: {
        hideDetails: 'Hide details',
        loadMoreData: 'Load more data',
        noData: 'No data found',
        selectAll: 'Select all',
        showDetails: 'Show details'
    },
    es: {
        hideDetails: 'Ocultar detalles',
        loadMoreData: 'Cargar más resultados',
        noData: 'Datos no encontrados',
        selectAll: 'Seleccionar todos',
        showDetails: 'Mostrar detalles'
    },
    pt: {
        hideDetails: 'Ocultar detalhes',
        loadMoreData: 'Carregar mais resultados',
        noData: 'Nenhum dado encontrado',
        selectAll: 'Selecionar todos',
        showDetails: 'Exibir detalhes'
    },
    ru: {
        hideDetails: 'Скрыть детали',
        loadMoreData: 'Загрузить больше результатов',
        noData: 'Данные не найдены',
        selectAll: 'Выбрать все',
        showDetails: 'Посмотреть детали'
    }
};
/**
 * @description
 *
 * Componente de lista que recebe um array de objetos e renderiza de forma dinâmica os dados de
 * acordo com a necessidade de cada tela e deve ser utilizado em conjunto com as diretivas de *templates*
 *  **[p-list-view-content-template](/documentation/po-list-view-content-template)** e
 * **[p-list-view-detail-template](/documentation/po-list-view-detail-template)**.
 *
 * O componente disponibiliza uma área específica para exibição informações adicionais,
 * através da diretiva **[p-list-view-detail-template](/documentation/po-list-view-detail-template)**.
 */
var PoListViewBaseComponent = /** @class */ (function () {
    function PoListViewBaseComponent() {
        this.selectAll = false;
        this.showHeader = false;
        /**
         * Recebe uma ação, que será executada quando clicar no botão "Carregar mais resultados".
         *
         * > Caso nenhuma ação for definida o mesmo não ficará visível.
         */
        this.showMore = new EventEmitter();
        /**
         * Ação que será executada ao clicar no título.
         *
         * Ao ser disparado, o método inserido na ação irá receber como parâmetro o item da lista clicado.
         */
        this.titleAction = new EventEmitter();
    }
    Object.defineProperty(PoListViewBaseComponent.prototype, "actions", {
        get: function () {
            return this._actions;
        },
        /**
         * @optional
         *
         * @description
         *
         * Lista de ações que serão exibidas no componente.
         */
        set: function (value) {
            this._actions = Array.isArray(value) ? value : [];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PoListViewBaseComponent.prototype, "height", {
        get: function () {
            return this._height;
        },
        /**
         * @optional
         *
         * @description
         *
         * Define a altura do `po-list-view` em *pixels*.
         */
        set: function (height) {
            this._height = height;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PoListViewBaseComponent.prototype, "hideSelectAll", {
        get: function () {
            return this._hideSelectAll;
        },
        /**
         * @description
         *
         * Esconde o *checkbox* para seleção de todos os itens.
         *
         * @default `false`
         */
        set: function (hideSelectAll) {
            this._hideSelectAll = convertToBoolean(hideSelectAll);
            this.showMainHeader();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PoListViewBaseComponent.prototype, "items", {
        get: function () {
            return this._items;
        },
        /** Lista de itens que serão exibidos no componente. */
        set: function (value) {
            this._items = Array.isArray(value) ? value : [];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PoListViewBaseComponent.prototype, "literals", {
        get: function () {
            return this._literals || poListViewLiteralsDefault[browserLanguage()];
        },
        /**
         * @optional
         *
         * @description
         *
         * Objeto com as literais usadas no `po-list-view`.
         *
         * Existem duas maneiras de customizar o componente, passando um objeto com todas as literais disponíveis:
         *
         * ```
         *  const customLiterals: PoListViewLiterals = {
         *    hideDetail: 'Ocultar detalhes completamente',
         *    loadMoreData: 'Mais dados',
         *    showDetail: 'Mostrar mais detalhes',
         *    selectAll: 'Selecionar todos os itens'
         *  };
         * ```
         *
         * Ou passando apenas as literais que deseja customizar:
         *
         * ```
         *  const customLiterals: PoListViewLiterals = {
         *    showDetail: 'Mostrar mais detalhes'
         *  };
         * ```
         *
         * E para carregar as literais customizadas, basta apenas passar o objeto para o componente.
         *
         * ```
         * <po-list-view
         *   [p-literals]="customLiterals">
         * </po-list-view>
         * ```
         *
         * > O objeto padrão de literais será traduzido de acordo com o idioma do browser (pt, en, es).
         */
        set: function (value) {
            if (value instanceof Object && !(value instanceof Array)) {
                this._literals = __assign(__assign(__assign({}, poListViewLiteralsDefault[poLocaleDefault]), poListViewLiteralsDefault[browserLanguage()]), value);
            }
            else {
                this._literals = poListViewLiteralsDefault[browserLanguage()];
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PoListViewBaseComponent.prototype, "select", {
        get: function () {
            return this._select;
        },
        /**
         * @optional
         *
         * @description
         *
         * Habilita um *checkbox* para cada item da lista. Todos os items possuem a propriedade dinâmica `$selected` para identificar se o
         * item está selecionado, por exemplo:
         *
         * ```
         *  item.$selected
         *
         *  // ou
         *
         *  item['$selected']
         * ```
         *
         * @default `false`
         */
        set: function (select) {
            this._select = convertToBoolean(select);
            this.showMainHeader();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PoListViewBaseComponent.prototype, "showMoreDisabled", {
        get: function () {
            return this._showMoreDisabled;
        },
        /**
         * @optional
         *
         * @description
         *
         * Indica que o botão `Carregar Mais Resultados` será desabilitado.
         */
        set: function (value) {
            this._showMoreDisabled = convertToBoolean(value);
        },
        enumerable: true,
        configurable: true
    });
    PoListViewBaseComponent.prototype.onClickAction = function (listViewAction, item) {
        var cleanItem = this.deleteInternalAttrs(item);
        if (listViewAction.action) {
            listViewAction.action(cleanItem);
        }
    };
    PoListViewBaseComponent.prototype.onShowMore = function () {
        this.showMore.emit();
    };
    PoListViewBaseComponent.prototype.runTitleAction = function (listItem) {
        var itemWithPublicProperties = this.deleteInternalAttrs(listItem);
        this.titleAction.emit(itemWithPublicProperties);
    };
    PoListViewBaseComponent.prototype.selectAllListItems = function () {
        var _this = this;
        if (!this.hideSelectAll) {
            this.selectAll = !this.selectAll;
            this.items.forEach(function (item) {
                item.$selected = _this.selectAll;
            });
        }
    };
    PoListViewBaseComponent.prototype.selectListItem = function (row) {
        row.$selected = !row.$selected;
        this.selectAll = this.checkIfItemsAreSelected(this.items);
    };
    PoListViewBaseComponent.prototype.deleteInternalAttrs = function (item) {
        var itemCopy = item ? __assign({}, item) : undefined;
        for (var key in itemCopy) {
            if (itemCopy.hasOwnProperty(key) && key.startsWith('$')) {
                delete itemCopy[key];
            }
        }
        return itemCopy;
    };
    PoListViewBaseComponent.prototype.checkIfItemsAreSelected = function (items) {
        var someCheckedOrIndeterminate = function (item) { return item.$selected || item.$selected === null; };
        var everyChecked = function (item) { return item.$selected; };
        if (items.every(everyChecked)) {
            return true;
        }
        if (items.some(someCheckedOrIndeterminate)) {
            return null;
        }
        return false;
    };
    PoListViewBaseComponent.prototype.showMainHeader = function () {
        this.showHeader = !!(this.select && !this.hideSelectAll && this.items && this.items.length);
    };
    __decorate([
        Input('p-actions'),
        __metadata("design:type", Array),
        __metadata("design:paramtypes", [Array])
    ], PoListViewBaseComponent.prototype, "actions", null);
    __decorate([
        Input('p-height'),
        __metadata("design:type", Number),
        __metadata("design:paramtypes", [Number])
    ], PoListViewBaseComponent.prototype, "height", null);
    __decorate([
        Input('p-hide-select-all'),
        __metadata("design:type", Boolean),
        __metadata("design:paramtypes", [Boolean])
    ], PoListViewBaseComponent.prototype, "hideSelectAll", null);
    __decorate([
        Input('p-items'),
        __metadata("design:type", Array),
        __metadata("design:paramtypes", [Array])
    ], PoListViewBaseComponent.prototype, "items", null);
    __decorate([
        Input('p-literals'),
        __metadata("design:type", Object),
        __metadata("design:paramtypes", [Object])
    ], PoListViewBaseComponent.prototype, "literals", null);
    __decorate([
        Input('p-property-link'),
        __metadata("design:type", String)
    ], PoListViewBaseComponent.prototype, "propertyLink", void 0);
    __decorate([
        Input('p-property-title'),
        __metadata("design:type", String)
    ], PoListViewBaseComponent.prototype, "propertyTitle", void 0);
    __decorate([
        Input('p-select'),
        __metadata("design:type", Boolean),
        __metadata("design:paramtypes", [Boolean])
    ], PoListViewBaseComponent.prototype, "select", null);
    __decorate([
        Input('p-show-more-disabled'),
        __metadata("design:type", Boolean),
        __metadata("design:paramtypes", [Boolean])
    ], PoListViewBaseComponent.prototype, "showMoreDisabled", null);
    __decorate([
        Output('p-show-more'),
        __metadata("design:type", EventEmitter)
    ], PoListViewBaseComponent.prototype, "showMore", void 0);
    __decorate([
        Output('p-title-action'),
        __metadata("design:type", EventEmitter)
    ], PoListViewBaseComponent.prototype, "titleAction", void 0);
    PoListViewBaseComponent = __decorate([
        Directive()
    ], PoListViewBaseComponent);
    return PoListViewBaseComponent;
}());
export { PoListViewBaseComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tbGlzdC12aWV3LWJhc2UuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHBvLXVpL25nLWNvbXBvbmVudHMvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9wby1saXN0LXZpZXcvcG8tbGlzdC12aWV3LWJhc2UuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXZFLE9BQU8sRUFBRSxlQUFlLEVBQUUsZUFBZSxFQUFFLGdCQUFnQixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFLdEYsTUFBTSxDQUFDLElBQU0seUJBQXlCLEdBQUc7SUFDdkMsRUFBRSxFQUFzQjtRQUN0QixXQUFXLEVBQUUsY0FBYztRQUMzQixZQUFZLEVBQUUsZ0JBQWdCO1FBQzlCLE1BQU0sRUFBRSxlQUFlO1FBQ3ZCLFNBQVMsRUFBRSxZQUFZO1FBQ3ZCLFdBQVcsRUFBRSxjQUFjO0tBQzVCO0lBQ0QsRUFBRSxFQUFzQjtRQUN0QixXQUFXLEVBQUUsa0JBQWtCO1FBQy9CLFlBQVksRUFBRSx1QkFBdUI7UUFDckMsTUFBTSxFQUFFLHNCQUFzQjtRQUM5QixTQUFTLEVBQUUsbUJBQW1CO1FBQzlCLFdBQVcsRUFBRSxrQkFBa0I7S0FDaEM7SUFDRCxFQUFFLEVBQXNCO1FBQ3RCLFdBQVcsRUFBRSxrQkFBa0I7UUFDL0IsWUFBWSxFQUFFLDBCQUEwQjtRQUN4QyxNQUFNLEVBQUUsd0JBQXdCO1FBQ2hDLFNBQVMsRUFBRSxrQkFBa0I7UUFDN0IsV0FBVyxFQUFFLGlCQUFpQjtLQUMvQjtJQUNELEVBQUUsRUFBc0I7UUFDdEIsV0FBVyxFQUFFLGVBQWU7UUFDNUIsWUFBWSxFQUFFLDhCQUE4QjtRQUM1QyxNQUFNLEVBQUUsbUJBQW1CO1FBQzNCLFNBQVMsRUFBRSxhQUFhO1FBQ3hCLFdBQVcsRUFBRSxtQkFBbUI7S0FDakM7Q0FD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LEtBQUssQ0FBQyxTQUFTLENBQUM7a0NBQWtCLEtBQUs7eUNBQUwsS0FBSzt3REFFdkM7SUEwQ29CO1FBQXBCLEtBQUssQ0FBQyxZQUFZLENBQUM7OzsyREFVbkI7SUFPeUI7UUFBekIsS0FBSyxDQUFDLGlCQUFpQixDQUFDOztpRUFBdUI7SUFHckI7UUFBMUIsS0FBSyxDQUFDLGtCQUFrQixDQUFDOztrRUFBd0I7SUFvQi9CO1FBQWxCLEtBQUssQ0FBQyxVQUFVLENBQUM7Ozt5REFHakI7SUFhOEI7UUFBOUIsS0FBSyxDQUFDLHNCQUFzQixDQUFDOzs7bUVBRTdCO0lBV3NCO1FBQXRCLE1BQU0sQ0FBQyxhQUFhLENBQUM7a0NBQVksWUFBWTs2REFBZ0M7SUFPcEQ7UUFBekIsTUFBTSxDQUFDLGdCQUFnQixDQUFDO2tDQUFlLFlBQVk7Z0VBQWdDO0lBcEx6RSx1QkFBdUI7UUFEbkMsU0FBUyxFQUFFO09BQ0MsdUJBQXVCLENBb1BuQztJQUFELDhCQUFDO0NBQUEsQUFwUEQsSUFvUEM7U0FwUFksdUJBQXVCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT3V0cHV0LCBEaXJlY3RpdmUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgYnJvd3Nlckxhbmd1YWdlLCBwb0xvY2FsZURlZmF1bHQsIGNvbnZlcnRUb0Jvb2xlYW4gfSBmcm9tICcuLi8uLi91dGlscy91dGlsJztcblxuaW1wb3J0IHsgUG9MaXN0Vmlld0FjdGlvbiB9IGZyb20gJy4vaW50ZXJmYWNlcy9wby1saXN0LXZpZXctYWN0aW9uLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQb0xpc3RWaWV3TGl0ZXJhbHMgfSBmcm9tICcuL2ludGVyZmFjZXMvcG8tbGlzdC12aWV3LWxpdGVyYWxzLmludGVyZmFjZSc7XG5cbmV4cG9ydCBjb25zdCBwb0xpc3RWaWV3TGl0ZXJhbHNEZWZhdWx0ID0ge1xuICBlbjogPFBvTGlzdFZpZXdMaXRlcmFscz57XG4gICAgaGlkZURldGFpbHM6ICdIaWRlIGRldGFpbHMnLFxuICAgIGxvYWRNb3JlRGF0YTogJ0xvYWQgbW9yZSBkYXRhJyxcbiAgICBub0RhdGE6ICdObyBkYXRhIGZvdW5kJyxcbiAgICBzZWxlY3RBbGw6ICdTZWxlY3QgYWxsJyxcbiAgICBzaG93RGV0YWlsczogJ1Nob3cgZGV0YWlscydcbiAgfSxcbiAgZXM6IDxQb0xpc3RWaWV3TGl0ZXJhbHM+e1xuICAgIGhpZGVEZXRhaWxzOiAnT2N1bHRhciBkZXRhbGxlcycsXG4gICAgbG9hZE1vcmVEYXRhOiAnQ2FyZ2FyIG3DoXMgcmVzdWx0YWRvcycsXG4gICAgbm9EYXRhOiAnRGF0b3Mgbm8gZW5jb250cmFkb3MnLFxuICAgIHNlbGVjdEFsbDogJ1NlbGVjY2lvbmFyIHRvZG9zJyxcbiAgICBzaG93RGV0YWlsczogJ01vc3RyYXIgZGV0YWxsZXMnXG4gIH0sXG4gIHB0OiA8UG9MaXN0Vmlld0xpdGVyYWxzPntcbiAgICBoaWRlRGV0YWlsczogJ09jdWx0YXIgZGV0YWxoZXMnLFxuICAgIGxvYWRNb3JlRGF0YTogJ0NhcnJlZ2FyIG1haXMgcmVzdWx0YWRvcycsXG4gICAgbm9EYXRhOiAnTmVuaHVtIGRhZG8gZW5jb250cmFkbycsXG4gICAgc2VsZWN0QWxsOiAnU2VsZWNpb25hciB0b2RvcycsXG4gICAgc2hvd0RldGFpbHM6ICdFeGliaXIgZGV0YWxoZXMnXG4gIH0sXG4gIHJ1OiA8UG9MaXN0Vmlld0xpdGVyYWxzPntcbiAgICBoaWRlRGV0YWlsczogJ9Ch0LrRgNGL0YLRjCDQtNC10YLQsNC70LgnLFxuICAgIGxvYWRNb3JlRGF0YTogJ9CX0LDQs9GA0YPQt9C40YLRjCDQsdC+0LvRjNGI0LUg0YDQtdC30YPQu9GM0YLQsNGC0L7QsicsXG4gICAgbm9EYXRhOiAn0JTQsNC90L3Ri9C1INC90LUg0L3QsNC50LTQtdC90YsnLFxuICAgIHNlbGVjdEFsbDogJ9CS0YvQsdGA0LDRgtGMINCy0YHQtScsXG4gICAgc2hvd0RldGFpbHM6ICfQn9C+0YHQvNC+0YLRgNC10YLRjCDQtNC10YLQsNC70LgnXG4gIH1cbn07XG5cbi8qKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogQ29tcG9uZW50ZSBkZSBsaXN0YSBxdWUgcmVjZWJlIHVtIGFycmF5IGRlIG9iamV0b3MgZSByZW5kZXJpemEgZGUgZm9ybWEgZGluw6JtaWNhIG9zIGRhZG9zIGRlXG4gKiBhY29yZG8gY29tIGEgbmVjZXNzaWRhZGUgZGUgY2FkYSB0ZWxhIGUgZGV2ZSBzZXIgdXRpbGl6YWRvIGVtIGNvbmp1bnRvIGNvbSBhcyBkaXJldGl2YXMgZGUgKnRlbXBsYXRlcypcbiAqICAqKltwLWxpc3Qtdmlldy1jb250ZW50LXRlbXBsYXRlXSgvZG9jdW1lbnRhdGlvbi9wby1saXN0LXZpZXctY29udGVudC10ZW1wbGF0ZSkqKiBlXG4gKiAqKltwLWxpc3Qtdmlldy1kZXRhaWwtdGVtcGxhdGVdKC9kb2N1bWVudGF0aW9uL3BvLWxpc3Qtdmlldy1kZXRhaWwtdGVtcGxhdGUpKiouXG4gKlxuICogTyBjb21wb25lbnRlIGRpc3BvbmliaWxpemEgdW1hIMOhcmVhIGVzcGVjw61maWNhIHBhcmEgZXhpYmnDp8OjbyBpbmZvcm1hw6fDtWVzIGFkaWNpb25haXMsXG4gKiBhdHJhdsOpcyBkYSBkaXJldGl2YSAqKltwLWxpc3Qtdmlldy1kZXRhaWwtdGVtcGxhdGVdKC9kb2N1bWVudGF0aW9uL3BvLWxpc3Qtdmlldy1kZXRhaWwtdGVtcGxhdGUpKiouXG4gKi9cbkBEaXJlY3RpdmUoKVxuZXhwb3J0IGNsYXNzIFBvTGlzdFZpZXdCYXNlQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBfYWN0aW9uczogQXJyYXk8UG9MaXN0Vmlld0FjdGlvbj47XG4gIHByaXZhdGUgX2hlaWdodDogbnVtYmVyO1xuICBwcml2YXRlIF9oaWRlU2VsZWN0QWxsOiBib29sZWFuO1xuICBwcml2YXRlIF9pdGVtczogQXJyYXk8YW55PjtcbiAgcHJpdmF0ZSBfbGl0ZXJhbHM6IFBvTGlzdFZpZXdMaXRlcmFscztcbiAgcHJpdmF0ZSBfc2VsZWN0OiBib29sZWFuO1xuICBwcml2YXRlIF9zaG93TW9yZURpc2FibGVkOiBib29sZWFuO1xuXG4gIHBvcHVwVGFyZ2V0OiBhbnk7XG4gIHNlbGVjdEFsbDogYm9vbGVhbiA9IGZhbHNlO1xuICBzaG93SGVhZGVyOiBib29sZWFuID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogTGlzdGEgZGUgYcOnw7VlcyBxdWUgc2Vyw6NvIGV4aWJpZGFzIG5vIGNvbXBvbmVudGUuXG4gICAqL1xuICBASW5wdXQoJ3AtYWN0aW9ucycpIHNldCBhY3Rpb25zKHZhbHVlOiBBcnJheTxQb0xpc3RWaWV3QWN0aW9uPikge1xuICAgIHRoaXMuX2FjdGlvbnMgPSBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW107XG4gIH1cblxuICBnZXQgYWN0aW9ucygpIHtcbiAgICByZXR1cm4gdGhpcy5fYWN0aW9ucztcbiAgfVxuXG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIERlZmluZSBhIGFsdHVyYSBkbyBgcG8tbGlzdC12aWV3YCBlbSAqcGl4ZWxzKi5cbiAgICovXG4gIEBJbnB1dCgncC1oZWlnaHQnKSBzZXQgaGVpZ2h0KGhlaWdodDogbnVtYmVyKSB7XG4gICAgdGhpcy5faGVpZ2h0ID0gaGVpZ2h0O1xuICB9XG5cbiAgZ2V0IGhlaWdodCgpIHtcbiAgICByZXR1cm4gdGhpcy5faGVpZ2h0O1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBFc2NvbmRlIG8gKmNoZWNrYm94KiBwYXJhIHNlbGXDp8OjbyBkZSB0b2RvcyBvcyBpdGVucy5cbiAgICpcbiAgICogQGRlZmF1bHQgYGZhbHNlYFxuICAgKi9cbiAgQElucHV0KCdwLWhpZGUtc2VsZWN0LWFsbCcpIHNldCBoaWRlU2VsZWN0QWxsKGhpZGVTZWxlY3RBbGw6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9oaWRlU2VsZWN0QWxsID0gY29udmVydFRvQm9vbGVhbihoaWRlU2VsZWN0QWxsKTtcbiAgICB0aGlzLnNob3dNYWluSGVhZGVyKCk7XG4gIH1cblxuICBnZXQgaGlkZVNlbGVjdEFsbCgpIHtcbiAgICByZXR1cm4gdGhpcy5faGlkZVNlbGVjdEFsbDtcbiAgfVxuXG4gIC8qKiBMaXN0YSBkZSBpdGVucyBxdWUgc2Vyw6NvIGV4aWJpZG9zIG5vIGNvbXBvbmVudGUuICovXG4gIEBJbnB1dCgncC1pdGVtcycpIHNldCBpdGVtcyh2YWx1ZTogQXJyYXk8YW55Pikge1xuICAgIHRoaXMuX2l0ZW1zID0gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFtdO1xuICB9XG5cbiAgZ2V0IGl0ZW1zKCkge1xuICAgIHJldHVybiB0aGlzLl9pdGVtcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIE9iamV0byBjb20gYXMgbGl0ZXJhaXMgdXNhZGFzIG5vIGBwby1saXN0LXZpZXdgLlxuICAgKlxuICAgKiBFeGlzdGVtIGR1YXMgbWFuZWlyYXMgZGUgY3VzdG9taXphciBvIGNvbXBvbmVudGUsIHBhc3NhbmRvIHVtIG9iamV0byBjb20gdG9kYXMgYXMgbGl0ZXJhaXMgZGlzcG9uw612ZWlzOlxuICAgKlxuICAgKiBgYGBcbiAgICogIGNvbnN0IGN1c3RvbUxpdGVyYWxzOiBQb0xpc3RWaWV3TGl0ZXJhbHMgPSB7XG4gICAqICAgIGhpZGVEZXRhaWw6ICdPY3VsdGFyIGRldGFsaGVzIGNvbXBsZXRhbWVudGUnLFxuICAgKiAgICBsb2FkTW9yZURhdGE6ICdNYWlzIGRhZG9zJyxcbiAgICogICAgc2hvd0RldGFpbDogJ01vc3RyYXIgbWFpcyBkZXRhbGhlcycsXG4gICAqICAgIHNlbGVjdEFsbDogJ1NlbGVjaW9uYXIgdG9kb3Mgb3MgaXRlbnMnXG4gICAqICB9O1xuICAgKiBgYGBcbiAgICpcbiAgICogT3UgcGFzc2FuZG8gYXBlbmFzIGFzIGxpdGVyYWlzIHF1ZSBkZXNlamEgY3VzdG9taXphcjpcbiAgICpcbiAgICogYGBgXG4gICAqICBjb25zdCBjdXN0b21MaXRlcmFsczogUG9MaXN0Vmlld0xpdGVyYWxzID0ge1xuICAgKiAgICBzaG93RGV0YWlsOiAnTW9zdHJhciBtYWlzIGRldGFsaGVzJ1xuICAgKiAgfTtcbiAgICogYGBgXG4gICAqXG4gICAqIEUgcGFyYSBjYXJyZWdhciBhcyBsaXRlcmFpcyBjdXN0b21pemFkYXMsIGJhc3RhIGFwZW5hcyBwYXNzYXIgbyBvYmpldG8gcGFyYSBvIGNvbXBvbmVudGUuXG4gICAqXG4gICAqIGBgYFxuICAgKiA8cG8tbGlzdC12aWV3XG4gICAqICAgW3AtbGl0ZXJhbHNdPVwiY3VzdG9tTGl0ZXJhbHNcIj5cbiAgICogPC9wby1saXN0LXZpZXc+XG4gICAqIGBgYFxuICAgKlxuICAgKiA+IE8gb2JqZXRvIHBhZHLDo28gZGUgbGl0ZXJhaXMgc2Vyw6EgdHJhZHV6aWRvIGRlIGFjb3JkbyBjb20gbyBpZGlvbWEgZG8gYnJvd3NlciAocHQsIGVuLCBlcykuXG4gICAqL1xuICBASW5wdXQoJ3AtbGl0ZXJhbHMnKSBzZXQgbGl0ZXJhbHModmFsdWU6IFBvTGlzdFZpZXdMaXRlcmFscykge1xuICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCAmJiAhKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICB0aGlzLl9saXRlcmFscyA9IHtcbiAgICAgICAgLi4ucG9MaXN0Vmlld0xpdGVyYWxzRGVmYXVsdFtwb0xvY2FsZURlZmF1bHRdLFxuICAgICAgICAuLi5wb0xpc3RWaWV3TGl0ZXJhbHNEZWZhdWx0W2Jyb3dzZXJMYW5ndWFnZSgpXSxcbiAgICAgICAgLi4udmFsdWVcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpdGVyYWxzID0gcG9MaXN0Vmlld0xpdGVyYWxzRGVmYXVsdFticm93c2VyTGFuZ3VhZ2UoKV07XG4gICAgfVxuICB9XG5cbiAgZ2V0IGxpdGVyYWxzKCkge1xuICAgIHJldHVybiB0aGlzLl9saXRlcmFscyB8fCBwb0xpc3RWaWV3TGl0ZXJhbHNEZWZhdWx0W2Jyb3dzZXJMYW5ndWFnZSgpXTtcbiAgfVxuXG4gIC8qKiBSZWNlYmUgdW1hIHByb3ByaWVkYWRlIHF1ZSBzZXLDoSB1dGlsaXphZGEgcGFyYSByZWN1cGVyYXIgbyB2YWxvciBkbyBvYmpldG8gcXVlIHNlcsOhIHVzYWRvIGNvbW8gbGluayBwYXJhIG8gdMOtdHVsby4gKi9cbiAgQElucHV0KCdwLXByb3BlcnR5LWxpbmsnKSBwcm9wZXJ0eUxpbms/OiBzdHJpbmc7XG5cbiAgLyoqIFJlY2ViZSB1bWEgcHJvcHJpZWRhZGUgcXVlIHNlcsOhIHV0aWxpemFkYSBwYXJhIHJlY3VwZXJhciBvIHZhbG9yIGRvIG9iamV0byBxdWUgc2Vyw6EgZXhpYmlkbyBjb21vIG8gdMOtdHVsbyBkZSBjYWRhIGl0ZW0uICovXG4gIEBJbnB1dCgncC1wcm9wZXJ0eS10aXRsZScpIHByb3BlcnR5VGl0bGU/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogSGFiaWxpdGEgdW0gKmNoZWNrYm94KiBwYXJhIGNhZGEgaXRlbSBkYSBsaXN0YS4gVG9kb3Mgb3MgaXRlbXMgcG9zc3VlbSBhIHByb3ByaWVkYWRlIGRpbsOibWljYSBgJHNlbGVjdGVkYCBwYXJhIGlkZW50aWZpY2FyIHNlIG9cbiAgICogaXRlbSBlc3TDoSBzZWxlY2lvbmFkbywgcG9yIGV4ZW1wbG86XG4gICAqXG4gICAqIGBgYFxuICAgKiAgaXRlbS4kc2VsZWN0ZWRcbiAgICpcbiAgICogIC8vIG91XG4gICAqXG4gICAqICBpdGVtWyckc2VsZWN0ZWQnXVxuICAgKiBgYGBcbiAgICpcbiAgICogQGRlZmF1bHQgYGZhbHNlYFxuICAgKi9cbiAgQElucHV0KCdwLXNlbGVjdCcpIHNldCBzZWxlY3Qoc2VsZWN0OiBib29sZWFuKSB7XG4gICAgdGhpcy5fc2VsZWN0ID0gY29udmVydFRvQm9vbGVhbihzZWxlY3QpO1xuICAgIHRoaXMuc2hvd01haW5IZWFkZXIoKTtcbiAgfVxuXG4gIGdldCBzZWxlY3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3NlbGVjdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIEluZGljYSBxdWUgbyBib3TDo28gYENhcnJlZ2FyIE1haXMgUmVzdWx0YWRvc2Agc2Vyw6EgZGVzYWJpbGl0YWRvLlxuICAgKi9cbiAgQElucHV0KCdwLXNob3ctbW9yZS1kaXNhYmxlZCcpIHNldCBzaG93TW9yZURpc2FibGVkKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5fc2hvd01vcmVEaXNhYmxlZCA9IGNvbnZlcnRUb0Jvb2xlYW4odmFsdWUpO1xuICB9XG5cbiAgZ2V0IHNob3dNb3JlRGlzYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX3Nob3dNb3JlRGlzYWJsZWQ7XG4gIH1cblxuICAvKipcbiAgICogUmVjZWJlIHVtYSBhw6fDo28sIHF1ZSBzZXLDoSBleGVjdXRhZGEgcXVhbmRvIGNsaWNhciBubyBib3TDo28gXCJDYXJyZWdhciBtYWlzIHJlc3VsdGFkb3NcIi5cbiAgICpcbiAgICogPiBDYXNvIG5lbmh1bWEgYcOnw6NvIGZvciBkZWZpbmlkYSBvIG1lc21vIG7Do28gZmljYXLDoSB2aXPDrXZlbC5cbiAgICovXG4gIEBPdXRwdXQoJ3Atc2hvdy1tb3JlJykgc2hvd01vcmU/OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIC8qKlxuICAgKiBBw6fDo28gcXVlIHNlcsOhIGV4ZWN1dGFkYSBhbyBjbGljYXIgbm8gdMOtdHVsby5cbiAgICpcbiAgICogQW8gc2VyIGRpc3BhcmFkbywgbyBtw6l0b2RvIGluc2VyaWRvIG5hIGHDp8OjbyBpcsOhIHJlY2ViZXIgY29tbyBwYXLDom1ldHJvIG8gaXRlbSBkYSBsaXN0YSBjbGljYWRvLlxuICAgKi9cbiAgQE91dHB1dCgncC10aXRsZS1hY3Rpb24nKSB0aXRsZUFjdGlvbj86IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgb25DbGlja0FjdGlvbihsaXN0Vmlld0FjdGlvbjogUG9MaXN0Vmlld0FjdGlvbiwgaXRlbSkge1xuICAgIGNvbnN0IGNsZWFuSXRlbSA9IHRoaXMuZGVsZXRlSW50ZXJuYWxBdHRycyhpdGVtKTtcbiAgICBpZiAobGlzdFZpZXdBY3Rpb24uYWN0aW9uKSB7XG4gICAgICBsaXN0Vmlld0FjdGlvbi5hY3Rpb24oY2xlYW5JdGVtKTtcbiAgICB9XG4gIH1cblxuICBvblNob3dNb3JlKCk6IHZvaWQge1xuICAgIHRoaXMuc2hvd01vcmUuZW1pdCgpO1xuICB9XG5cbiAgcnVuVGl0bGVBY3Rpb24obGlzdEl0ZW06IGFueSkge1xuICAgIGNvbnN0IGl0ZW1XaXRoUHVibGljUHJvcGVydGllcyA9IHRoaXMuZGVsZXRlSW50ZXJuYWxBdHRycyhsaXN0SXRlbSk7XG4gICAgdGhpcy50aXRsZUFjdGlvbi5lbWl0KGl0ZW1XaXRoUHVibGljUHJvcGVydGllcyk7XG4gIH1cblxuICBzZWxlY3RBbGxMaXN0SXRlbXMoKSB7XG4gICAgaWYgKCF0aGlzLmhpZGVTZWxlY3RBbGwpIHtcbiAgICAgIHRoaXMuc2VsZWN0QWxsID0gIXRoaXMuc2VsZWN0QWxsO1xuXG4gICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIGl0ZW0uJHNlbGVjdGVkID0gdGhpcy5zZWxlY3RBbGw7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBzZWxlY3RMaXN0SXRlbShyb3c6IGFueSkge1xuICAgIHJvdy4kc2VsZWN0ZWQgPSAhcm93LiRzZWxlY3RlZDtcblxuICAgIHRoaXMuc2VsZWN0QWxsID0gdGhpcy5jaGVja0lmSXRlbXNBcmVTZWxlY3RlZCh0aGlzLml0ZW1zKTtcbiAgfVxuXG4gIHByaXZhdGUgZGVsZXRlSW50ZXJuYWxBdHRycyhpdGVtKSB7XG4gICAgY29uc3QgaXRlbUNvcHkgPSBpdGVtID8geyAuLi5pdGVtIH0gOiB1bmRlZmluZWQ7XG5cbiAgICBmb3IgKGNvbnN0IGtleSBpbiBpdGVtQ29weSkge1xuICAgICAgaWYgKGl0ZW1Db3B5Lmhhc093blByb3BlcnR5KGtleSkgJiYga2V5LnN0YXJ0c1dpdGgoJyQnKSkge1xuICAgICAgICBkZWxldGUgaXRlbUNvcHlba2V5XTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaXRlbUNvcHk7XG4gIH1cblxuICBwcml2YXRlIGNoZWNrSWZJdGVtc0FyZVNlbGVjdGVkKGl0ZW1zOiBBcnJheTxhbnk+KTogYm9vbGVhbiB7XG4gICAgY29uc3Qgc29tZUNoZWNrZWRPckluZGV0ZXJtaW5hdGUgPSBpdGVtID0+IGl0ZW0uJHNlbGVjdGVkIHx8IGl0ZW0uJHNlbGVjdGVkID09PSBudWxsO1xuICAgIGNvbnN0IGV2ZXJ5Q2hlY2tlZCA9IGl0ZW0gPT4gaXRlbS4kc2VsZWN0ZWQ7XG5cbiAgICBpZiAoaXRlbXMuZXZlcnkoZXZlcnlDaGVja2VkKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGl0ZW1zLnNvbWUoc29tZUNoZWNrZWRPckluZGV0ZXJtaW5hdGUpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBwcml2YXRlIHNob3dNYWluSGVhZGVyKCkge1xuICAgIHRoaXMuc2hvd0hlYWRlciA9ICEhKHRoaXMuc2VsZWN0ICYmICF0aGlzLmhpZGVTZWxlY3RBbGwgJiYgdGhpcy5pdGVtcyAmJiB0aGlzLml0ZW1zLmxlbmd0aCk7XG4gIH1cbn1cbiJdfQ==